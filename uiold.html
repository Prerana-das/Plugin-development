<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/thomas-lowry/figma-plugin-ds/dist/figma-plugin-ds.css">
<style>
 input{
   display: block;
   padding: 15px;
   margin-top: 15px;
 }
 body{
   padding: 2em;
 }
 div{
   margin: 1em;
 }
</style>

<h2>Custom plugin heading</h2>
<div>
  <label for="username">Username</label>
  <input class="input__field" type="text" value="Username" id="username">
  <label for="name">Name</label>
  <input class="input__field" type="text" value="Name" id="name">
  <label for="description">Description</label>
  <input type="textarea" row="5" value="Description" id="description">
  <div class="switch">
      <input class="switch__toggle" type="checkbox" id="dark-mode-on">
      <label class="switch__label" for="dark-mode-on">Dark mode</label>
  </div>
  <div class="radio">
    <input id="radioButton1" type="radio" class="radio__button"  name="varientGroup" value="1">
    <label for="radioButton1" class="radio__label">no img</label>

    <input id="radioButton2" type="radio" class="radio__button"  name="varientGroup" value="2">
    <label for="radioButton2" class="radio__label">single</label>

    <input id="radioButton3" type="radio" class="radio__button"  name="varientGroup" value="3">
    <label for="radioButton3" class="radio__label">carousel</label>
  </div>
  <button class="button button--primary" id="submit-post">Submit</button>

  <div id="item" style="background:#C4C4C4; width:100px; height:100px; cursor:grab;" draggable="true">
    
  </div>
  <svg  width="48" height="48" viewBox="0 0 48 48" fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <path fill-rule="evenodd" clip-rule="evenodd"
      d="M20.7692 4C11.5078 4 4 11.5078 4 20.7692C4 30.0306 11.5078 37.5385 20.7692 37.5385C25.4002 37.5385 29.5911 35.6626 32.6269 32.6269C35.6626 29.5911 37.5385 25.4002 37.5385 20.7692C37.5385 11.5078 30.0306 4 20.7692 4ZM2 20.7692C2 10.4033 10.4033 2 20.7692 2C31.1352 2 39.5385 10.4033 39.5385 20.7692C39.5385 25.592 37.7183 29.9914 34.7294 33.3152L45.7071 44.2929C46.0976 44.6834 46.0976 45.3166 45.7071 45.7071C45.3166 46.0976 44.6834 46.0976 44.2929 45.7071L33.3152 34.7294C29.9914 37.7183 25.592 39.5385 20.7692 39.5385C10.4033 39.5385 2 31.1352 2 20.7692Z"
      fill="black" />
  </svg>
  <!-- <iframe width="700px" src="http://localhost:8082/testingfigma" title="W3Schools Free Online Web Tutorials"> -->
  <img id="svgg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAApgAAAKYB3X3/OAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANCSURBVEiJtZZPbBtFFMZ/M7ubXdtdb1xSFyeilBapySVU8h8OoFaooFSqiihIVIpQBKci6KEg9Q6H9kovIHoCIVQJJCKE1ENFjnAgcaSGC6rEnxBwA04Tx43t2FnvDAfjkNibxgHxnWb2e/u992bee7tCa00YFsffekFY+nUzFtjW0LrvjRXrCDIAaPLlW0nHL0SsZtVoaF98mLrx3pdhOqLtYPHChahZcYYO7KvPFxvRl5XPp1sN3adWiD1ZAqD6XYK1b/dvE5IWryTt2udLFedwc1+9kLp+vbbpoDh+6TklxBeAi9TL0taeWpdmZzQDry0AcO+jQ12RyohqqoYoo8RDwJrU+qXkjWtfi8Xxt58BdQuwQs9qC/afLwCw8tnQbqYAPsgxE1S6F3EAIXux2oQFKm0ihMsOF71dHYx+f3NND68ghCu1YIoePPQN1pGRABkJ6Bus96CutRZMydTl+TvuiRW1m3n0eDl0vRPcEysqdXn+jsQPsrHMquGeXEaY4Yk4wxWcY5V/9scqOMOVUFthatyTy8QyqwZ+kDURKoMWxNKr2EeqVKcTNOajqKoBgOE28U4tdQl5p5bwCw7BWquaZSzAPlwjlithJtp3pTImSqQRrb2Z8PHGigD4RZuNX6JYj6wj7O4TFLbCO/Mn/m8R+h6rYSUb3ekokRY6f/YukArN979jcW+V/S8g0eT/N3VN3kTqWbQ428m9/8k0P/1aIhF36PccEl6EhOcAUCrXKZXXWS3XKd2vc/TRBG9O5ELC17MmWubD2nKhUKZa26Ba2+D3P+4/MNCFwg59oWVeYhkzgN/JDR8deKBoD7Y+ljEjGZ0sosXVTvbc6RHirr2reNy1OXd6pJsQ+gqjk8VWFYmHrwBzW/n+uMPFiRwHB2I7ih8ciHFxIkd/3Omk5tCDV1t+2nNu5sxxpDFNx+huNhVT3/zMDz8usXC3ddaHBj1GHj/As08fwTS7Kt1HBTmyN29vdwAw+/wbwLVOJ3uAD1wi/dUH7Qei66PfyuRj4Ik9is+hglfbkbfR3cnZm7chlUWLdwmprtCohX4HUtlOcQjLYCu+fzGJH2QRKvP3UNz8bWk1qMxjGTOMThZ3kvgLI5AzFfo379UAAAAASUVORK5CYII="
>


<div>
  <div class="icons-grid">
  
    <span class="icon" draggable="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-activity"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
    </span>
<p>iconssss</p>
    <span class="icon" draggable="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-airplay"><path d="M5 17H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-1"></path><polygon points="12 15 17 21 7 21 12 15"></polygon></svg>
    </span>

    <span class="icon" draggable="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-circle"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
    </span>

    <span class="icon" draggable="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-align-center"><line x1="18" y1="10" x2="6" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="18" y1="18" x2="6" y2="18"></line></svg>
    </span>

    <span class="icon" draggable="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-anchor"><circle cx="12" cy="5" r="3"></circle><line x1="12" y1="22" x2="12" y2="8"></line><path d="M5 12H2a10 10 0 0 0 20 0h-3"></path></svg>
    </span>

    <span class="icon" draggable="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left-circle"><circle cx="12" cy="12" r="10"></circle><polyline points="12 8 8 12 12 16"></polyline><line x1="16" y1="12" x2="8" y2="12"></line></svg>
    </span>

    <span class="icon" draggable="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bar-chart"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>
    </span>

    <span class="icon" draggable="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bluetooth"><polyline points="6.5 6.5 17.5 17.5 12 23 12 1 17.5 6.5 6.5 17.5"></polyline></svg>
    </span>
  </div>

  <form>
    <label>Parenting strategy:</label>
    <div>
      <input type="radio" name="parentingStrategy" value="page">Page
    </div>
    <div>
      <input type="radio" name="parentingStrategy" value="immediate" checked="checked">In parentable node
    </div>
  </form>
</div>
</div>

<script>
  document.getElementById("submit-post").onclick=()=>{
    console.log("calling func");
    const username=document.getElementById("username").value;
    const name=document.getElementById("name").value;
    const description=document.getElementById("description").value;

    const darkModeState =document.getElementById("dark-mode-on").checked;
    const imageVariant= document.querySelector("input[name='varientGroup']:checked").value;

    parent.postMessage({pluginMessage:{name,username,description,darkModeState,imageVariant}},'*');
  }


//   window.onmessage = async (event) => {
//   if (event.data.pluginMessage.type === 'networkRequest') {
//     var request = new XMLHttpRequest()
//     // This link has random lorem ipsum text
//     request.open('GET', 'http://localhost:3333')
//     request.responseType = 'text'
//     request.onload = () => {


//       console.log("my res");
//       window.parent.postMessage({pluginMessage: request.response}, '*')
//     };
//     request.send()
//   }
// }

//darg drop
// Initialize offset variables to be assigned later
/***
let offsetX = 0;
	let offsetY = 0;

	document.getElementById('item').addEventListener('dragstart', e => {
		// Getting the offset position (The position of the cursor relative to the top-left corner of item being dragged)
		offsetX = e.offsetX;
		offsetY = e.offsetY;
	});

	document.getElementById('item').addEventListener('dragend', e => {
		// Don't proceed if the item was dropped inside the plugin window.
		if (e.view.length === 0) return;

		// Getting the position of the cursor relative to the top-left corner of the browser page (Where the hamburger icon is)
		const dropPosition = {
			clientX: e.clientX,
			clientY: e.clientY
		};

		// Getting the size of the app/browser window.
		const windowSize = {
			width: window.outerWidth,
			height: window.outerHeight
		};

		// These are the offsets set from the dragstart event.
		const offset = {
			x: offsetX,
			y: offsetY
		};

		const itemSize = {
			width: e.target.clientWidth,
			height: e.target.clientHeight
		};

    const svgg=document.getElementById("svgg");
    console.log("svggsvggsvggsvgg",svgg);


		// Sending the variables over to the main code.
		window.parent.postMessage({ pluginMessage: { dropPosition, windowSize, offset, itemSize,svgg } }, '*');
	});
**/

  //icon drag drop=====================
  const icons = document.getElementsByClassName('icon');

for (const icon of icons) {
  icon.addEventListener('dragend', e => {
    // Don't proceed if the item was dropped inside the plugin window.
    if (e.view.length === 0) return;

    const file = new File(
      [e.target.innerHTML],
      'content.svg',
      { type: 'image/svg+xml' }
    );

    const parentingStrategy = document.querySelector('input[name="parentingStrategy"]:checked').value;

    // This will trigger a drop event in Figma that we can register a callback for
    window.parent.postMessage(
      {
        pluginDrop: {
          clientX: e.clientX,
          clientY: e.clientY,
          files: [file],
          dropMetadata: { parentingStrategy }
        }
      },
      '*'
    );
   });
}



</script>

